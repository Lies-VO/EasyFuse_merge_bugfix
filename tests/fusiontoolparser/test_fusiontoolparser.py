from bin.fusiontoolparser_helper import parse_fusioncatcher_results
from bin.fusiontoolparser_helper import parse_starfusion_results
from bin.fusiontoolparser_helper import parse_arriba_results

def test_parse_fusioncatcher_results():
    infile = "tests/fusiontoolparser/fusioncatcher_1.txt"
    infile2 = "tests/fusiontoolparser/fusioncatcher_2.tsv"
    assert parse_fusioncatcher_results(infile, infile2) == {
        '21:41494380:-_7:13935843:-': [
            'TMPRSS2_ETV1', '21:41494380:-', '7:13935843:-', '16', '367'
        ], 
        '22:29287134:+_12:50814280:+': [
            'EWSR1_ATF1', '22:29287134:+', '12:50814280:+', '23', '363'
        ], 
        '7:92003235:+_7:140787584:-': [
            'AKAP9_BRAF', '7:92003235:+', '7:140787584:-', '21', '340'
        ], 
        '12:11869969:+_15:87940753:-': [
            'ETV6_NTRK3', '12:11869969:+', '15:87940753:-', '23', '299'
        ], 
        '8:42968214:+_10:43116584:+': [
            'HOOK3_RET', '8:42968214:+', '10:43116584:+', '20', '298'
        ], 
        '22:29287134:+_11:128807180:+': [
            'EWSR1_FLI1', '22:29287134:+', '11:128807180:+', '22', '282'
        ], 
        '19:15254152:-_15:34347969:+': [
            'BRD4_NUTM1', '19:15254152:-', '15:34347969:+', '20', '244'
        ], 
        '5:150404680:-_6:117324415:-': [
            'CD74_ROS1', '5:150404680:-', '6:117324415:-', '22', '152'
        ]
    }

def test_parse_starfusion_results():
    infile = "tests/fusiontoolparser/starfusion.tsv"
    assert parse_starfusion_results(infile) == {
        '12:11869969:+_15:87940753:-': [
            'ETV6_NTRK3', '12:11869969:+', '15:87940753:-', '160', '390'
        ], 
        '22:29287134:+_11:128807180:+': [
            'EWSR1_FLI1', '22:29287134:+', '11:128807180:+', '140', '333'
        ], 
        '19:15254152:-_15:34347969:+': [
            'BRD4_NUTM1', '19:15254152:-', '15:34347969:+', '132', '260'
        ], 
        '22:29287134:+_12:50814280:+': [
            'EWSR1_ATF1', '22:29287134:+', '12:50814280:+', '129', '367'
        ], 
        '5:150404680:-_6:117324415:-': [
            'CD74_ROS1', '5:150404680:-', '6:117324415:-', '125', '140'
        ], 
        '7:92003235:+_7:140787584:-': [
            'AKAP9_BRAF', '7:92003235:+', '7:140787584:-', '120', '348'
        ], 
        '8:42968214:+_10:43116584:+': [
            'HOOK3_RET', '8:42968214:+', '10:43116584:+', '94', '276'
        ], 
        '21:41494375:-_7:13935838:-': [
            'TMPRSS2_ETV1', '21:41494375:-', '7:13935838:-', '76', '321'
        ], 
        '2:42301394:+_2:29223584:-': [
            'EML4_ALK', '2:42301394:+', '2:29223584:-', '61', '256'
        ]
    }

def test_parse_arriba_results():
    infile = "tests/fusiontoolparser/arriba.tsv"
    assert parse_arriba_results(infile) == {
        '12:11869969:+_15:87940753:-': [
            'ETV6_NTRK3', '12:11869969:+', '15:87940753:-', '130', '300'
        ], 
        '7:92003235:+_7:140787584:-': [
            'AKAP9_BRAF', '7:92003235:+', '7:140787584:-', '113', '299'
        ], 
        '22:29287134:+_11:128807180:+': [
            'EWSR1_FLI1', '22:29287134:+', '11:128807180:+', '70', '299'
        ], 
        '8:42968214:+_10:43116584:+': [
            'HOOK3_RET', '8:42968214:+', '10:43116584:+', '88', '275'
        ], 
        '22:29287134:+_12:50814280:+': [
            'EWSR1_ATF1', '22:29287134:+', '12:50814280:+', '49', '299'
        ], 
        '19:15254152:-_15:34347969:+': [
            'BRD4_NUTM1', '19:15254152:-', '15:34347969:+', '82', '232'
        ], 
        '2:42301394:+_2:29223584:-': [
            'EML4_ALK', '2:42301394:+', '2:29223584:-', '52', '221'
        ], 
        '5:150404680:-_6:117324415:-': [
            'CD74_ROS1', '5:150404680:-', '6:117324415:-', '75', '139'
        ], 
        '21:41494375:-_7:13935838:-': [
            'TMPRSS2_ETV1', '21:41494375:-', '7:13935838:-', '59', '300'
        ]
    }
